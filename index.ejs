<html lang="en">
  <head>
    <title>Unity Version Booter</title>
    <link rel="stylesheet" href="./css/photon.min.css">
    <link rel="stylesheet" href="./css/style.css">
  </head>
  <body>
    <div class="window">
        <header class="toolbar toolbar-header">
            <div class="toolbar-actions">
              <div class="btn-group">
                <button class="btn btn-default">
                    Unity Versions
                  <!-- <span class="icon icon-home"></span> -->
                </button>
                <button class="btn btn-default" onclick="navProjects()">
                    Projects
                  <!-- <span class="icon icon-folder"></span> -->
                </button>
                <button class="btn btn-default">
                  <span class="icon icon-cloud"></span>
                </button>
              </div>
            </div>
          </header>
        <div class="window-content">
          <div id="errorModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
              <span class="close">&times;</span>
              <strong>An error has occured when loading Unity</strong>
            </div>
          </div>
          <ul class="list-group">
            <% for (let i = 0; i < versions.ordered.length; i++) {%>
              <li class ="list-group-item">
                  <button id="<%= versions.ordered[i] %>" class="btn btn-positive btn-version">
                      <%= versions.ordered[i] %>
                  </button>
                  <div class="btn-group">
                    <% if (versions.targets[versions.ordered[i]].targets != null) { %>
                      <% for (let j = 0; j < versions.targets[versions.ordered[i]].targets.length; j++) {%>
                        <button class="btn-targets" id="<%= versions.ordered[i] %>" target="<%= versions.targets[versions.ordered[i]].targets[j] %>">
                          <img src="./icons/<%= versions.targets[versions.ordered[i]].targets[j] %>.png">
                        </button>
                      <% } %>
                    <% } %>
                  </div>
              </li>
            <% } %>
          </ul>
        </div>
      </div>
      <script>
        let electron = require('electron');
        let loadUnity = electron.remote.require('./main').loadUnity;

        let btns = document.getElementsByClassName('btn-version');
        for (let i = 0; i < btns.length; i++) {
          btns[i].addEventListener('click', () => {
            if (!loadUnity(btns[i].id, null, null)) {
                let modal = document.getElementById('errorModal');
                modal.style.display = "block";
              }
          })
        }
        btns = document.getElementsByClassName('btn-targets');
        for (let i = 0; i < btns.length; i++) {
          btns[i].addEventListener('click', () => {
            loadUnity(btns[i].id, btns[i].getAttribute('target'));
          })
        }

        let modal = document.getElementById("errorModal");
          let span = document.getElementsByClassName("close")[0];
          span.onclick = () => {
            modal.style.display = "none";
        }

        function navProjects() {
            console.log("nav called");
            let electron = require('electron');
            let navigateProjects = electron.remote.require('./main').navigateProjects;
            navigateProjects();
          }
          
      </script>
  </body>
</html>